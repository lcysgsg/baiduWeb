<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>work5</title>
    <style>

    ul {list-style:none;margin:10px;margin-left: -50px;height: 100px; }
    ul li {
      	float:  left;
        background-color: red;
        margin-left: 10px;
        padding: 7px;
        cursor: pointer;
    }
      /* #ul{
            margin:  5px;
        }
        #ul li{
            display:  inline-block;
            min-width:  50px;
            height:  30px;
            background:  #aaa;
            margin:  5px;
            cursor: pointer;
        }*/
    </style>
  </head>
<body>
   <!-- html 标签里的标准是双引号... -->
  <input type="text" name="input" id="input" autofocus placeholder="10-100且至多60个">
  <button id="inset_left">左侧入</button>
  <button id="inset_right">右侧入</button>
  <button id="outset_left">左侧出</button>
  <button id="outset_right">右侧出</button>
  <button id="sort">排序</button>


  <ul id="ul"></ul>
  <script>
    init();
    function init(){
      var btnInsetLeft = document.getElementById('inset_left');
      btnInsetLeft.addEventListener('click',function(){
        inset('left');
        del();
      });
      var btnInsetRight = document.getElementById('inset_right');
      btnInsetRight.addEventListener('click',function(){
        inset('right');
        del();
      });
      var btnOutsetLeft = document.getElementById('outset_left');
      btnOutsetLeft.addEventListener('click',function(){
        outset('left');
        del();
      });
      var btnOutsetRight = document.getElementById('outset_right');
      btnOutsetRight.addEventListener('click',function(){
        outset('right');
        del();
      });
      var btnSort = document.getElementById('sort');
      btnSort.addEventListener('click',function(){
        bubbleSort();
      });
    }
    function inset(direction){
      var length = document.getElementById('ul').children.length;
      if(length > 60-1){
        alert('队列元素数量最多限制为60个');
        return false;
      }
      var text = document.getElementById('input').value;
      if(isNaN(text) || text === ''){
        alert('请输入数字');
        return false;
      }else if(10 > Number(text) || Number(text) > 100){
        alert('请输入10-100的数字');
        return false;
      }
      // 感觉效果是一样的，因为添加的是最左边和最右边
      // 保存高度
      var highPx = text + 'px';
      var ul = document.getElementById('ul').innerHTML;
      if ( direction == 'left') {
          ul = '<li style="height:'+ highPx +'">'  + '</li>' + ul;
      } else if( direction == 'right'){
          ul = ul + '<li style="height:'+ highPx +'">'  + '</li>';
      }
      console.log(ul);
      document.getElementById('ul').innerHTML = ul;
      // 添加一次后 清空value
      document.getElementById('input').value = '';
      // 添加一次后光标定回去，提高点用户体验..
      document.getElementById('input').focus();
      // 我认为这里左入/右入，还是之前的方便，效率也应该会更高（应该会更高...= =）
      // var li = document.getElementById('ul').children;
      // var data = [];
      // if(direction == 'left'){
      //   data[0] = text + 'px';
      //   for (var i = 0; i <= li.length - 1; i++) {
      //     data[i+1] = li[i].style.height;
      //   }
      // }else if(direction == 'right'){
      //   for (var i = 0; i <= li.length - 1; i++) {
      //     data[i] = li[i].style.height;
      //   }
      //   data[li.length] = text + 'px';
      // }
      // formatting(data);
    }
    function outset(direction){
      var li = document.getElementById('ul').children;
      // new Array() 这样是手动创建一个数组，可以访问数组原型中的方法，查找原型链是有时间代价的。
      // var data = new Array();
      // 所以在这里使用直接量的话会好一点，因为不用访问方法
      var data = [];
      for (var i = li.length - 1; i >= 0; i--) {
        data[i] = li[i].style.height;
      }
      // 这里会报 're' is already defined ,'re' uesd out of scope 两个错误
      // 所以应该先声明re
      // （猜测是应该是 re调用了方法影响到了
      var re;
      if(direction == 'left'){
        // var re = data.shift(); 
        re = data.shift(); 
      }else if(direction == 'right'){
        re = data.pop();
      }
      alert(re.slice(0,-2));
      formatting(data);
    }
    function del(){
      var del = document.getElementsByTagName('li');
      for (var i = del.length - 1; i >= 0; i--) {
        del[i].addEventListener('click',function(){
          this.parentNode.removeChild(this);
          // 我觉得不需要循环再输出，removeChild后就可以了，效果是没什么变化
          // var li = document.getElementById('ul').children;
          // var data = new Array();
          // for (var i = li.length - 1; i >= 0; i--) {
          //   data[i] = li[i].style.height;
          // }
          // formatting(data);
        });
      }
    }
    function formatting(data){
      var arr = '';
      for (var i = 0; i <= data.length - 1; i++) {
        var left = (i*20)+'px';
        arr += '<li style="height:'+data[i]+';left:'+ left +'"></li>';
      }
      // console.log(arr);
      document.getElementById('ul').innerHTML = arr;
      document.getElementById('input').value = '';
      document.getElementById('input').focus();
      // del();
    }
    // px 消失
    function bubbleSort(){
      var li = document.getElementById('ul').children;
      var items = [];
      for (var i = li.length - 1; i >= 0; i--) {
        items[i] = li[i].style.height.slice(0,-2);
      }
      var len = items.length,  stop;
      // for循环里的 i,j其实不要写重比较好,for 外面还是可以访问到 i,j 的。会提示‘已经定义’
      for (var j = 0; j < len; j++){
        for (l = 0, stop = len-j; l < stop; l++){
          if (items[l] > items[l+1]){
            swap(items, l, l+1);
          }
        }
      }
      // 不加回去的话排序后 height 是没有'px'单位的
      // items 是去除了'px'的，应该要加回去
      var data = [];
      for (var k = 0; k < li.length; k++) {
          data[k] = items[k]+'px';
      }
      formatting(data);
    }
    function swap(items, firstIndex, secondIndex){
      var temp = items[firstIndex];
      items[firstIndex] = items[secondIndex];
      items[secondIndex] = temp;
    }
  </script>
</body>
</html>
